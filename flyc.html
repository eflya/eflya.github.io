

import pandas as pd

import matplotlib pyplot as plt

class MSDataAnalyzer:

def load_maxquant_results(self, protein_groups_path):

return pd read_csv(protein_groups_path, sep='\t')

def plot_lfq_intensity(self, df, sample_columns):

"""绘制Label-free定量强度热图"""

selected = df[['Majority protein IDs'] + sample_columns]

selected = selected set_index('Majority protein IDs')

selected = selected T fillna(0)

plt figure(figsize=(10, 8))

plt imshow(selected values, cmap='viridis', aspect='auto')

plt colorbar(label='Log2 Intensity')

plt xticks(range(len(selected columns)), selected columns, rotation=45)

plt yticks(range(len(selected index)), selected index)

plt title('Protein Abundance Heatmap')

plt tight_layout()

plt show()

# 示例：分析MaxQuant输出结果

analyzer = MSDataAnalyzer()

df = analyzer load_maxquant_results("combined/txt/proteinGroups txt")

analyzer plot_lfq_intensity(df, ['LFQ intensity sample1', 'LFQ intensity sample2'])
